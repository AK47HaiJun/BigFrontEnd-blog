# HTTP

## 第一章  WEB网络基础

### 写在前面的话

> 网上已经有很多不错 有关HTTP 文章， 此文为记录学习`HTTP` 
>
> 最近在项目开发中，对于HTTP 这块比较懵，来补补基础吧！
>
> 学习HTTP的同时，有必要了解下``TCP/IP`协议族。 
>
> 通常使用的网络都是在`TCP / IP` 协议族的基础上运作，而且HTTP 属于`TCP/IP`的一个子集。

### TCP / IP

#### TCP/IP 协议族

> 不同硬件与操作系统之间通信有需要有一定规则来约束，这样可以统一沟通的条件。
>
> `TCP / IP` 是互联网相关各协议族的总称，它不只是 单纯的 指 `TCP` 和 `IP`协议，
>
> 它有 `FTP` ,  `SNMP` , `HTTP` , `PPPoE`........  组成的 协议族。

#### TCP/ IP 分层

> `TCP / IP ` 协议族 按层次分为 4 层：  `应用层` , `传输层` , `网络层`, `数据链路层`

##### 应用层

> `作用`：  应用层决定了向用户提供应用服务时通信的活动。
>
> TCP / IP 协议族内预存了各类通用的应用服务。
>
> 例如： FTP(文件传输协议）  DNS(域名系统）HTTP

##### 传输层

> `作用`:   两台计算机之间的数据传输，服务于应用层。
>
> 在传输层有两个性质不同的协议： TCP(传输控制协议) UDP(用户数据协议）

##### 网路层

> `作用`:   用来处理在网络上流动的数据包,以何种方式传递给对方。
>
> 数据包是网络传输的最小数据单位。
>
> 网络层 决定了 通过什么样的方式把数据包传递给对方。
>
> 网络层 最重要的功能是： 路由数据包。它会根据网络上路由IP， 网络拥塞情况，选择一条最合适的路由路线，以最快的速度将数据包传递给对方。

##### 数据链路层

> `作用`:   用来处理连接网络的硬件部分。
>
> 硬件上的范畴均在链路层的作用范围之内

<img src="https://ae01.alicdn.com/kf/Hbde019c5623f45a9897b99238db11c661.jpg">

#### TCP / IP 通信传输流

> 采用 `TCP / IP ` 协议进行网络通信时， 客户端(发送端)  会从应用层 往下走， 一层 一层的传输， 每进入一层，被被打上标记序号以及端口号， 当客户端 走完 自己的 4 层时， 会进入  服务端(接收端) ，它是按 链路层 然后 一层一层 往上走， 每进入一层， 取消一个 标记序号， 直到顶层(应用层)，这时， 服务端才接收到了 `客户端`  向  `服务端`
>
> 发送的请求。
>
> `服务端` 向  `客户端`  发送请求，和之前的顺序相反。
>
> 服务端(应用层----------> 数据链路层)
>
> 客户端(数据链路层 ---------------> 应用层)

<img src="https://ae01.alicdn.com/kf/Hfc857208658049a0802072d48ec62f57z.jpg">



#### HTTP 相关的协议

##### 负责传输的IP协议

> `IP`  ： 它是网际协议，它位于网络层。
>
> `作用`:    把各种数据包传递给对方。
>
> 要保证可以 把数据包准确的传递给对方，有两个条件：
>
>  `IP`  地址： 它标明了要传递到对方的 ip  地址。
>
> `MAC` 地址： 它是指网卡的固定地址。
>
> `IP 和 MAC  是验证 一个身份的 关键`
>
> IP 地址 可以 和 MAC 地址 进行匹配，IP 地址可以更换，但MAC 地址基本不会更换。
>
> `计算机于计算机之间通信时，它不会直接查找到对方IP的，中间过程会经历 设备中转，在进行中转的同时，它 会 采用 ARP 协议 来 推出 IP 地址的 MAC 地址，经过多次中转最终找到对方的 MAC 地址， MAC 地址 于 IP 地址匹配， 成功的建立了连接。`
>
> <hr/>
>
> `ARP` ： 它是一用来解析地址的协议。根据对方IP地址可以反查出对应的MAC 地址

<img src="https://ae01.alicdn.com/kf/Ha2e2c0a57e384702b9ad88e6fa386e4e5.jpg">

##### 确保可靠性TCP 协议

> `TCP`   位于传输层， 提供可靠的字节流服务。
>
> `字节流服务` :   为了方便传输，它会将大块数据分割成 以报文段为单位的数据进行管理。
>
> 为了`可靠的安全`的可以传递给对方数据， `TCP 采用 三次握手策略`,
>
> `SYN 同步序列编号`          `ACK 确认字符`
>
>  `第一次握手` :  发送端会发送一个带有 SYN 标志的数据包给对方。
>
> `第二次握手` :  对方(接收端)收到发送端 发送过来的 SYN 包， 回传一个带有 SYN / ACK 标志的包 来标识接收成功。
>
> `第三次握手` :   发送端 回传一个 ACK 包 表示 `握手接收` 

######  TCP 为何要三次握手呢？

> `第一次握手`:  客户端 向 服务端 发送请求
>
> `第二次握手` : 服务端 接收 客户端发来的请求，进行处理。
>
> 前 两次握手 已经实现  请求处理过程，那么为什么还是需要 建立第三次握手呢？
>
> 如果不进行 `第三次握手` ,  假如，`第一次握手` , 客户端由于网络原因，请求延迟发送， 你以为 这样就结束了请求，但网络节点正常后，它还会发送这个请求，这是一个早已失效的报文；`第二次握手`,服务端 接收到 客户端发送过来的 延迟请求，但此时客户端没有发送任何数据，而服务端还在等候 客户端， 造成了资源浪费。 
>
> <hr/>
>
> `第三次握手是为了防止已经失效的连接请求报文段突然又传到服务端，因而产生错误。`

<img src="https://ae01.alicdn.com/kf/H2082adfd9df249698d01130e4f6afa59J.jpg">




###### 让三次握握手 更生动

> 在恋爱关系中，就是 确定 一下， A  是否 为 `单相思`, 
>
> 如果不三次握手， B 早已和别的男朋友........  而 A 还在 苦苦 等待 B 的接受。
>
> `干嘛不三次握手嘛`
>
> 
>
> A 向 B 表白了；
>
> B  收到  A 的 表白了， B 要回应 A ，`我不喜欢你 `
>
> A  收到 了 B 回应， 让他 脱离了 `单相思`



<img src="https://ae01.alicdn.com/kf/H962d07a36e7f436cbe189d004f0a1818s.jpg">

##### 负责域名解析DNS 服务

> `DNS`   服务 和HTTP 协议 都位于应用层协议。
>
> `作用` :  提供`域名` 到 `IP` 地址解析服务。
>
> `DNS 协议提供通过域名查找IP 地址，  也可以通过IP 地址反查 域名`

#### HTTP  与 各种协议之间的关系

> HTTP 与上面各个协议之间 串联起来 理解各个协议个作用。

<img src="https://ae01.alicdn.com/kf/H34ea3367658440cdaf6c2a2d4e7cbb0bA.jpg">

<center>图片来源 HTTP图解</center>

#### URI  与 URL 

##### 什么是URI  URL 

> `URI`   统一资源标识符。
>
> `URI  是  Uniform   Resource  Identifier 的缩写` 
>
> `Uniform  统一格式`
>
> `Resource  可标识资源`
>
> `Idetifier  可标识对象，标识符`
>
> URI  用字符串 标识 互联网资源， 而URL 表示资源地点。
>
> <hr/>
>
> `URL` 统一资源定位符， 这个相信大家已经很了解了。

##### URI 格式

<img src="https://ae01.alicdn.com/kf/H6e4e297fd55f45a08b3b6ede28daec70B.jpg">



<hr/>

> ​       到现在，我们了解了`TCP / IP ` 协议族 的组成以及分层，还有最重要的 `三次握手`,做一个不再 `单相思`的小男孩；还有有关HTTP 相关知识。
>
> 这只是刚开始，`路漫漫其修远兮吾将上下而求索`.
>
> 写此文，为记录学习 `HTTP`,  大手请手下留情。





## 第二章 HTTP 特性

### 1. HTTP 协议用于客户端 和服务器之间通信

### 2.  通过请求 和响应交换达成通信

> 客户端发送的为 `请求报文`
>
> `请求报文`：  请求方法，  请求URI ，  协议版本， 可选请求首部字段和内容实体构成。
>
> 服务端发送的为 `响应报文`
>
> `响应报文`：  协议版本， 状态码， 解释状态码原因短语， 可选响应首部字段以及主体构成

<img src="https://s1.ax1x.com/2020/09/06/wZQSRP.png" alt="wZQSRP.png" border="0" />

<a href="https://imgchr.com/i/wZQKMT"><img src="https://s1.ax1x.com/2020/09/06/wZQKMT.jpg" alt="wZQKMT.jpg" border="0" /></a>

### 3. HTTP 无状态协议

> 无状态协议： HTTP协议不对请求和响应之间的通信状态进行保存。
>
> 优点： 可以更快处理大量事务，确保协议的可伸缩性。
>
> HTTP  要想实现保持状态，就得依靠`Cookie`

### 4. 通过URI  来定位资源

### 5. 持久连接通信

> 在HTTP 1.0 中， 每进行一次HTTP通信就要断开一次TCP连接。
>
> > 假定在访问一个HTML 文件时，它包括图片，音频.... ， 它在请求HTML文件时，同时会断开重新连接请求图片，音频...文件，重复循环，知道请求完，造成了不必要得TCP 连接消耗。
>
> #### 持久连接： 只要任意一段没有断开连接，那么`TCP` 就不会断开连接。
>
> 优点：  减少了TCP 连接开销，减轻了服务器的负载。
>
> 它还有一个特性就是`管线化`
>
> 管线化： 在请求多的时候，不会因为堵塞而影响请求加载，它是异步的，不是同步加载请求。
>
> #### HTTP 1.1 默认是持久连接。 HTTP 1.0 没有标准化。

### 6. Cookie 状态管理

> Cookie  是用来 解决HTTP 不能记录状态而生的，Cookie 是通过在请求报文和响应报文中写入Cookie 来控制客户端状态
>
> 萨达
>
> 流程：  
>
> - 1. 客户端发送请求
> - 2. 服务端接收请求，设置Set-Cookie 来设置Cookie信息
> - 3. 客户端接收Cookie，每次发送请求携带Cookie
> - 4. 服务端每次接收Cookie 来判定是否失效，执行接下来的请求

## 第三章 HTTP 报文以及状态码

### HTTP 报文

> HTTP 报文由  `报文首部` 和 `报文主体`组成。

#### HTTP 报文首部组成

> 请求报文和响应报文首部由以下组成：
>
> - 1. 请求行
>
>   > 包含： 请求方法，请求URI 和HTTP版本
>
> - 2. 状态行
>
>   > 包含： 状态码， 原因短语， HTTP版本
>
> - 3. 首部字段
>
>   > 包含： 通用首部，  请求首部， 响应首部， 实体首部。

###  状态码

> 状态码是 当客户端向服务端发送请求，服务端返回的一种响应，用户知道当前处理的情况如何。
>
> 状态码以3位数字和原因短语组成。

#### 状态码类别

|      |         类别         | y原因短语                |      |      |      |
| :--: | :------------------: | :----------------------- | ---- | ---- | ---- |
| 1xx  |    x信息性状态码     | j接收的请求正在处理      |      |      |      |
| 2xx  |      成功状态码      | 请求处理完毕             |      |      |      |
| 3xx  |     重定向状态码     | 需要进行附加操作完成请求 |      |      |      |
| 4xx  | 客户端错误原因状态码 | 服务器无法处理请求       |      |      |      |
| 5xx  |   服务器错误状态码   | 服务器处理请求出错       |      |      |      |

#### 2xx

- #### 200 OK    服务端正常处理了

- #### 204  No Content  客户端发送成功了，服务端不返回任何信息

- #### 206 Partial Content   客户端进行范围请求

#### 3xx

- #### 301  Moved Permanently永久重定向

- #### 302 Found 临时重定向

- #### 304  Not Modified   客户端发送请求，服务端没找到符合资源，不做返回

- ### 307 Temporary Redirect 临时重定向

#### 4xx

- #### 400   Bad Request  报文中存在语法错误，格式传递不对

- #### 401 Unauthorized  请求验证失败(用户验证失败)

- #### 403 Forbidden 客户端发起请求，别拒绝(权限授权访问)

- #### 404 Not Found  服务器上无法找到请求资源。

#### 5xx

- #### 500 Internal Server Error 服务器端出现了问题

- 503  Service Unavailable  服务器处于超负荷和停机



## 第四章  HTTP 报文首部

#### HTTP 首部字段

> 作用： 它可以给浏览器和服务器提供报文主体大小，所使用语言，认证信息等内容。
>
> 结构：  它由  首部字段名 和 字段值 构成。

#### 4 种 HTTP 首部字段类型

##### 通用首部字段

> 请求报文和响应报文都会使用的报文。

##### 请求首部字段

> 客户端向服务端发送的请求报文使用的首部。

##### 响应首部字段

> 从服务端向客户端发送的响应报文使用的首部，例如Cookie

##### 实体首部字段

> 对请求报文和响应报文的实体部分使用的首部，进行了 资源内容更新时间和实体有关信息。

#### 通用首部字段

![0B9J8e.jpg](https://s1.ax1x.com/2020/10/08/0B9J8e.jpg)

#### 请求首部字段

![0B9TGF.jpg](https://s1.ax1x.com/2020/10/08/0B9TGF.jpg)

#### 响应首部字段

![0BCZIf.jpg](https://s1.ax1x.com/2020/10/08/0BCZIf.jpg)

#### 实体首部字段

![0BCJoV.jpg](https://s1.ax1x.com/2020/10/08/0BCJoV.jpg)

